<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE rdf:RDF [
	<!ENTITY owl "http://www.w3.org/2002/07/owl#">
	<!ENTITY rdf "http://www.w3.org/1999/02/22-rdf-syntax-ns#">
	<!ENTITY rdfs "http://www.w3.org/2000/01/rdf-schema#">
	<!ENTITY stix "http://docs.oasis-open.org/cti/ns/stix#">
	<!ENTITY xsd "http://www.w3.org/2001/XMLSchema#">
]>
<rdf:RDF xml:base="http://docs.oasis-open.org/cti/ns/stix/malware-analysis"
	xmlns="http://docs.oasis-open.org/cti/ns/stix/malware-analysis#"
	xmlns:owl="http://www.w3.org/2002/07/owl#"
	xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
	xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"
	xmlns:stix="http://docs.oasis-open.org/cti/ns/stix#"
	xmlns:xsd="http://www.w3.org/2001/XMLSchema#">
	
	<owl:Ontology rdf:about="http://docs.oasis-open.org/cti/ns/stix/malware-analysis">
		<owl:imports rdf:resource="http://docs.oasis-open.org/cti/ns/stix/common-properties"/>
		<owl:imports rdf:resource="http://docs.oasis-open.org/cti/ns/stix/software"/>
		<owl:imports rdf:resource="http://docs.oasis-open.org/cti/ns/stix/vocabulary"/>
		<owl:versionInfo>2.1.0</owl:versionInfo>
	</owl:Ontology>
	
	<owl:Class rdf:about="&stix;MalwareAnalysis">
		<rdfs:subClassOf rdf:resource="&stix;StixDomainObject"/>
		<rdfs:subClassOf>
			<owl:Restriction>
				<owl:onProperty rdf:resource="&stix;analysis_definition_version"/>
				<owl:someValuesFrom rdf:resource="&xsd;string"/>
			</owl:Restriction>
		</rdfs:subClassOf>
		<rdfs:subClassOf>
			<owl:Restriction>
				<owl:onProperty rdf:resource="&stix;analysis_ended"/>
				<owl:someValuesFrom rdf:resource="&xsd;dateTime"/>
			</owl:Restriction>
		</rdfs:subClassOf>
		<rdfs:subClassOf>
			<owl:Restriction>
				<owl:onProperty rdf:resource="&stix;analysis_engine_version"/>
				<owl:someValuesFrom rdf:resource="&xsd;string"/>
			</owl:Restriction>
		</rdfs:subClassOf>
		<rdfs:subClassOf>
			<owl:Restriction>
				<owl:onProperty rdf:resource="&stix;analysis_sco_refs"/>
				<owl:someValuesFrom rdf:resource="&stix;StixCyberObservable"/>
			</owl:Restriction>
		</rdfs:subClassOf>
		<rdfs:subClassOf>
			<owl:Restriction>
				<owl:onProperty rdf:resource="&stix;analysis_sco_refs_string"/>
				<owl:someValuesFrom rdf:resource="&xsd;string"/>
			</owl:Restriction>
		</rdfs:subClassOf>
		<rdfs:subClassOf>
			<owl:Restriction>
				<owl:onProperty rdf:resource="&stix;analysis_started"/>
				<owl:someValuesFrom rdf:resource="&xsd;dateTime"/>
			</owl:Restriction>
		</rdfs:subClassOf>
		<rdfs:subClassOf>
			<owl:Restriction>
				<owl:onProperty rdf:resource="&stix;configuration_version"/>
				<owl:someValuesFrom rdf:resource="&xsd;string"/>
			</owl:Restriction>
		</rdfs:subClassOf>
		<rdfs:subClassOf>
			<owl:Restriction>
				<owl:onProperty rdf:resource="&stix;host_vm_ref"/>
				<owl:someValuesFrom rdf:resource="&stix;Software"/>
			</owl:Restriction>
		</rdfs:subClassOf>
		<rdfs:subClassOf>
			<owl:Restriction>
				<owl:onProperty rdf:resource="&stix;host_vm_ref_string"/>
				<owl:someValuesFrom rdf:resource="&xsd;string"/>
			</owl:Restriction>
		</rdfs:subClassOf>
		<rdfs:subClassOf>
			<owl:Restriction>
				<owl:onProperty rdf:resource="&stix;installed_software_refs"/>
				<owl:someValuesFrom rdf:resource="&stix;Software"/>
			</owl:Restriction>
		</rdfs:subClassOf>
		<rdfs:subClassOf>
			<owl:Restriction>
				<owl:onProperty rdf:resource="&stix;installed_software_refs_string"/>
				<owl:someValuesFrom rdf:resource="&xsd;string"/>
			</owl:Restriction>
		</rdfs:subClassOf>
		<rdfs:subClassOf>
			<owl:Restriction>
				<owl:onProperty rdf:resource="&stix;modules"/>
				<owl:someValuesFrom rdf:resource="&xsd;string"/>
			</owl:Restriction>
		</rdfs:subClassOf>
		<rdfs:subClassOf>
			<owl:Restriction>
				<owl:onProperty rdf:resource="&stix;operating_system_ref"/>
				<owl:someValuesFrom rdf:resource="&stix;Software"/>
			</owl:Restriction>
		</rdfs:subClassOf>
		<rdfs:subClassOf>
			<owl:Restriction>
				<owl:onProperty rdf:resource="&stix;operating_system_ref_string"/>
				<owl:someValuesFrom rdf:resource="&xsd;string"/>
			</owl:Restriction>
		</rdfs:subClassOf>
		<rdfs:subClassOf>
			<owl:Restriction>
				<owl:onProperty rdf:resource="&stix;product"/>
				<owl:someValuesFrom rdf:resource="&xsd;string"/>
			</owl:Restriction>
		</rdfs:subClassOf>
		<rdfs:subClassOf>
			<owl:Restriction>
				<owl:onProperty rdf:resource="&stix;result"/>
				<owl:someValuesFrom rdf:resource="&xsd;string"/>
			</owl:Restriction>
		</rdfs:subClassOf>
		<rdfs:subClassOf>
			<owl:Restriction>
				<owl:onProperty rdf:resource="&stix;result_name"/>
				<owl:someValuesFrom rdf:resource="&xsd;string"/>
			</owl:Restriction>
		</rdfs:subClassOf>
		<rdfs:subClassOf>
			<owl:Restriction>
				<owl:onProperty rdf:resource="&stix;sample_ref"/>
				<owl:someValuesFrom rdf:resource="&stix;StixCyberObservable"/>
			</owl:Restriction>
		</rdfs:subClassOf>
		<rdfs:subClassOf>
			<owl:Restriction>
				<owl:onProperty rdf:resource="&stix;sample_ref_string"/>
				<owl:someValuesFrom rdf:resource="&xsd;string"/>
			</owl:Restriction>
		</rdfs:subClassOf>
		<rdfs:subClassOf>
			<owl:Restriction>
				<owl:onProperty rdf:resource="&stix;submitted"/>
				<owl:someValuesFrom rdf:resource="&xsd;dateTime"/>
			</owl:Restriction>
		</rdfs:subClassOf>
		<rdfs:subClassOf>
			<owl:Restriction>
				<owl:onProperty rdf:resource="&stix;version"/>
				<owl:someValuesFrom rdf:resource="&xsd;string"/>
			</owl:Restriction>
		</rdfs:subClassOf>
		<rdfs:label xml:lang="en-us">Malware Analysis</rdfs:label>
		<rdfs:comment xml:lang="en-us">Malware Analysis captures the metadata and results of a particular static or dynamic analysis performed on a malware instance or family. One of result or analysis_sco_refs properties MUST be provided.</rdfs:comment>
	</owl:Class>
		
	<owl:DatatypeProperty rdf:about="&stix;analysis_definition_version">
		<rdfs:label>analysis_definition_version</rdfs:label>
		<rdfs:comment xml:lang="en-us">The version of the analysis definitions used by the analysis tool (including AV tools).</rdfs:comment>
		<rdfs:range rdf:resource="&xsd;string"/>
	</owl:DatatypeProperty>
	
	<owl:DatatypeProperty rdf:about="&stix;analysis_ended">
		<rdfs:label>analysis_ended</rdfs:label>
		<rdfs:comment xml:lang="en-us">The date and time that the malware analysis ended.</rdfs:comment>
		<rdfs:range rdf:resource="&xsd;dateTime"/>
	</owl:DatatypeProperty>
	
	<owl:DatatypeProperty rdf:about="&stix;analysis_engine_version">
		<rdfs:label>analysis_engine_version</rdfs:label>
		<rdfs:comment xml:lang="en-us">The version of the analysis engine or product (including AV engines) that was used to perform the analysis.</rdfs:comment>
		<rdfs:range rdf:resource="&xsd;string"/>
	</owl:DatatypeProperty>
	
	<owl:ObjectProperty rdf:about="&stix;analysis_sco_refs">
		<rdfs:label xml:lang="en-us">analysis_sco_refs</rdfs:label>
		<rdfs:comment xml:lang="en-us">This property contains the references to the STIX Cyber-observable Objects that were captured during the analysis process.</rdfs:comment>
		<rdfs:range rdf:resource="&stix;StixCyberObservable"/>
	</owl:ObjectProperty>
	
	<owl:DatatypeProperty rdf:about="&stix;analysis_sco_refs_string">
		<rdfs:label xml:lang="en-us">analysis_sco_refs_string</rdfs:label>
		<rdfs:comment xml:lang="en-us">This property contains the references to the STIX Cyber-observable Objects that were captured during the analysis process.</rdfs:comment>
		<rdfs:range rdf:resource="&xsd;string"/>
	</owl:DatatypeProperty>
	
	<owl:DatatypeProperty rdf:about="&stix;analysis_started">
		<rdfs:label>analysis_started</rdfs:label>
		<rdfs:comment xml:lang="en-us">The date and time that the malware analysis was initiated.</rdfs:comment>
		<rdfs:range rdf:resource="&xsd;dateTime"/>
	</owl:DatatypeProperty>
	
	<owl:DatatypeProperty rdf:about="&stix;configuration_version">
		<rdfs:label xml:lang="en-us">configuration_version</rdfs:label>
		<rdfs:comment xml:lang="en-us">The named configuration of additional product configuration parameters for this analysis run. For example, when a product is configured to do full depth analysis of Windowâ„¢ PE files. This configuration may have a named version and that named version can be captured in this property. This will ensure additional runs can be configured in the same way.</rdfs:comment>
		<rdfs:range rdf:resource="&xsd;string"/>
	</owl:DatatypeProperty>
	
	<owl:ObjectProperty rdf:about="&stix;host_vm_ref">
		<rdfs:label xml:lang="en-us">host_vm_ref</rdfs:label>
		<rdfs:comment xml:lang="en-us">A description of the virtual machine environment used to host the guest operating system (if applicable) that was used for the dynamic analysis of the malware instance or family. If this value is not included in conjunction with the operating_system_ref property, this means that the dynamic analysis may have been performed on bare metal (i.e. without virtualization) or the information was redacted. The value of this property MUST be the identifier for a SCO software object.</rdfs:comment>
		<rdfs:range rdf:resource="&stix;Software"/>
	</owl:ObjectProperty>
	
	<owl:DatatypeProperty rdf:about="&stix;host_vm_ref_string">
		<rdfs:label xml:lang="en-us">host_vm_ref_string</rdfs:label>
		<rdfs:comment xml:lang="en-us">A description of the virtual machine environment used to host the guest operating system (if applicable) that was used for the dynamic analysis of the malware instance or family. If this value is not included in conjunction with the operating_system_ref property, this means that the dynamic analysis may have been performed on bare metal (i.e. without virtualization) or the information was redacted. The value of this property MUST be the identifier for a SCO software object.</rdfs:comment>
		<rdfs:range rdf:resource="&xsd;string"/>
	</owl:DatatypeProperty>
	
	<owl:ObjectProperty rdf:about="&stix;installed_software_refs">
		<rdfs:label xml:lang="en-us">installed_software_refs</rdfs:label>
		<rdfs:comment xml:lang="en-us">Any non-standard software installed on the operating system (specified through the operating-system value) used for the dynamic analysis of the malware instance or family. The value of this property MUST be the identifier for a SCO software object.</rdfs:comment>
		<rdfs:range rdf:resource="&stix;Software"/>
	</owl:ObjectProperty>
	
	<owl:DatatypeProperty rdf:about="&stix;installed_software_refs_string">
		<rdfs:label xml:lang="en-us">installed_software_refs_string</rdfs:label>
		<rdfs:comment xml:lang="en-us">Any non-standard software installed on the operating system (specified through the operating-system value) used for the dynamic analysis of the malware instance or family. The value of this property MUST be the identifier for a SCO software object.</rdfs:comment>
		<rdfs:range rdf:resource="&xsd;string"/>
	</owl:DatatypeProperty>
	
	<owl:DatatypeProperty rdf:about="&stix;modules">
		<rdfs:label xml:lang="en-us">modules</rdfs:label>
		<rdfs:comment xml:lang="en-us">The specific analysis modules that were used and configured in the product during this analysis run. For example, configuring a product to support analysis of Dridex.</rdfs:comment>
		<rdfs:range rdf:resource="&xsd;string"/>
	</owl:DatatypeProperty>
	
	<owl:ObjectProperty rdf:about="&stix;operating_system_ref">
		<rdfs:label xml:lang="en-us">operating_system_ref</rdfs:label>
		<rdfs:comment xml:lang="en-us">The operating system used for the dynamic analysis of the malware instance or family. This applies to virtualized operating systems as well as those running on bare metal. The value of this property MUST be the identifier for a SCO software object.</rdfs:comment>
		<rdfs:range rdf:resource="&stix;Software"/>
	</owl:ObjectProperty>
	
	<owl:DatatypeProperty rdf:about="&stix;operating_system_ref_string">
		<rdfs:label xml:lang="en-us">operating_system_ref_string</rdfs:label>
		<rdfs:comment xml:lang="en-us">The operating system used for the dynamic analysis of the malware instance or family. This applies to virtualized operating systems as well as those running on bare metal. The value of this property MUST be the identifier for a SCO software object.</rdfs:comment>
		<rdfs:range rdf:resource="&xsd;string"/>
	</owl:DatatypeProperty>
	
	<owl:DatatypeProperty rdf:about="&stix;product">
		<rdfs:label xml:lang="en-us">product</rdfs:label>
		<rdfs:comment xml:lang="en-us">The name of the analysis engine or product that was used. Product names SHOULD be all lowercase with words separated by a dash &quot;-&quot;. For cases where the name of a product cannot be specified, a value of &quot;anonymized&quot; MUST be used.</rdfs:comment>
		<rdfs:range rdf:resource="&xsd;string"/>
	</owl:DatatypeProperty>
	
	<owl:DatatypeProperty rdf:about="&stix;result">
		<rdfs:label xml:lang="en-us">result</rdfs:label>
		<rdfs:comment xml:lang="en-us">The classification result as determined by the scanner or tool analysis process. The value for this property SHOULD come from the malware-result-ov open vocabulary.</rdfs:comment>
		<rdfs:range rdf:resource="&xsd;MalwareResultOv"/>
	</owl:DatatypeProperty>
	
	<owl:DatatypeProperty rdf:about="&stix;result_name">
		<rdfs:label xml:lang="en-us">result_name</rdfs:label>
		<rdfs:comment xml:lang="en-us">The classification result or name assigned to the malware instance by the scanner tool.</rdfs:comment>
		<rdfs:range rdf:resource="&xsd;string"/>
	</owl:DatatypeProperty>
	
	<owl:ObjectProperty rdf:about="&stix;sample_ref">
		<rdfs:label xml:lang="en-us">sample_ref</rdfs:label>
		<rdfs:comment xml:lang="en-us">This property contains the reference to the SCO file, network traffic or artifact object that this malware analysis was performed against. Caution should be observed when creating an SRO between Malware and Malware Analysis objects when the Malware sample_refs property does not contain the SCO that is included in the Malware Analysis sample_ref property. Note, this property can also contain a reference to an SCO which is not associated with Malware (i.e., some SCO which was scanned and found to be benign.)</rdfs:comment>
		<rdfs:range rdf:resource="&stix;StixCyberObservable"/>
	</owl:ObjectProperty>
	
	<owl:DatatypeProperty rdf:about="&stix;sample_ref_string">
		<rdfs:label xml:lang="en-us">sample_ref_string</rdfs:label>
		<rdfs:comment xml:lang="en-us">This property contains the reference to the SCO file, network traffic or artifact object that this malware analysis was performed against. Caution should be observed when creating an SRO between Malware and Malware Analysis objects when the Malware sample_refs property does not contain the SCO that is included in the Malware Analysis sample_ref property. Note, this property can also contain a reference to an SCO which is not associated with Malware (i.e., some SCO which was scanned and found to be benign.)</rdfs:comment>
		<rdfs:range rdf:resource="&xsd;string"/>
	</owl:DatatypeProperty>
	
	<owl:DatatypeProperty rdf:about="&stix;submitted">
		<rdfs:label>submitted</rdfs:label>
		<rdfs:comment xml:lang="en-us">The date and time that the malware was first submitted for scanning or analysis. This value will stay constant while the scanned date can change. For example, when Malware was submitted to a virus analysis tool.</rdfs:comment>
		<rdfs:range rdf:resource="&xsd;dateTime"/>
	</owl:DatatypeProperty>
	
	<owl:DatatypeProperty rdf:about="&stix;version">
		<rdfs:label xml:lang="en-us">version</rdfs:label>
		<rdfs:comment xml:lang="en-us">The version of the analysis product that was used to perform the analysis.</rdfs:comment>
		<rdfs:range rdf:resource="&xsd;string"/>
	</owl:DatatypeProperty>

</rdf:RDF>